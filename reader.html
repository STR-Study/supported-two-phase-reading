<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>STR Reading Demo</title>

<style>
body {
  font-family: sans-serif;
  display: flex;
  flex-direction: column;
  height: 100vh;
  height: 100dvh;
  margin: 0;
  background: white;
  overflow: hidden;
}

#counter {
  padding: 8px;
  font-size: 13px;
  color: #888;
  text-align: center;
  border-bottom: 1px solid #eee;
  flex-shrink: 0;
}

#content {
  flex-grow: 1;
  padding: 15px 20px;
  overflow-y: auto;
  font-size: 18px;
  line-height: 1.6;
  -webkit-overflow-scrolling: touch;
}

.footer {
  padding: 10px 20px;
  border-top: 1px solid #eee;
  background: white;
  display: flex;
  justify-content: center;
  padding-bottom: calc(10px + env(safe-area-inset-bottom));
}

button {
  width: 100%;
  max-width: 400px;
  padding: 14px;
  font-size: 18px;
  background: #007AFF;
  color: white;
  border: none;
  border-radius: 12px;
  cursor: pointer;
}

button:active { background: #0056b3; }
button.hidden { display: none; }
</style>
</head>

<body>

<div id="counter">
  Willkommen zur STR-Methode
</div>

<div id="content">
  <div style="text-align: center; font-family: Arial, sans-serif; padding: 20px; background: #f9f9f9; border: 2px solid #4CAF50; border-radius: 10px; max-width: 800px; margin: 0 auto;">
    <h2 style="color: #2E7D32; margin-bottom: 15px;">üìñ So liest du dieses Buch (STR-Methode)</h2>
    <p style="margin-bottom: 20px;"><strong>Du liest jeden Abschnitt <u>zweimal</u> ‚Äì zuerst mit Hilfe, dann ohne.</strong></p>
    <hr style="border: 1px dashed #4CAF50; margin: 20px 0;"/>
    <table style="width: 100%; margin: 15px 0; border-collapse: collapse;">
      <tbody><tr>
        <td style="width: 50%; text-align: center; vertical-align: top; padding: 15px;">
          <h3 style="color: #4CAF50; margin-bottom: 10px;">üîç Phase 1 ‚Äì Mit gr√ºner Hilfe</h3>
          <p style="margin: 5px 0;"><strong>Oben:</strong> Englisch + <span style="color: #4CAF50; font-weight: bold;">gr√ºne √úbersetzung</span></p>
          <ul style="text-align: left; margin: 10px auto; max-width: 250px; padding-left: 20px; list-style-type: disc;">
            <li>Lies normal</li>
            <li>Schau <u>nur bei Bedarf</u> in die gr√ºnen Klammern</li>
            <li>Bleib im Fluss!</li>
          </ul>
        </td>
        <td style="width: 50%; text-align: center; vertical-align: top; padding: 15px;">
          <h3 style="color: #D32F2F; margin-bottom: 10px;">üéØ Phase 2 ‚Äì Ohne Hilfe</h3>
          <p style="margin: 5px 0;"><strong>Unten:</strong> Derselbe Text ‚Äì <strong>nur Englisch</strong></p>
          <ul style="text-align: left; margin: 10px auto; max-width: 250px; padding-left: 20px; list-style-type: disc;">
            <li>Lies komplett ohne W√∂rterbuch</li>
            <li>Verstehe aus dem Ged√§chtnis</li>
            <li>Nur bei Notfall nach oben schauen</li>
          </ul>
        </td>
      </tr>
    </tbody></table>
    <hr style="border: 1px dashed #4CAF50; margin: 20px 0;"/>
    <p style="font-weight: bold; color: #1B5E20; margin: 15px 0 5px;">
      üìå <u>Immer dasselbe Muster:</u>
    </p>
    <p style="color: #1B5E20; margin: 0 0 5px;">
      ‚Üí Oben (mit gr√ºn) ‚Üí Unten (ohne)
    </p>
    <p style="color: #1B5E20; margin: 0 0 15px;">
      <b>So lernst du W√∂rter automatisch und liest immer sicherer!</b>
    </p>
  </div>
</div>

<div class="footer">
  <button id="main-btn" onclick="startReading()">Jetzt starten</button>
</div>

<script>
/* ================= CONFIG ================= */

const LOG_ENDPOINT =
  "https://script.google.com/macros/s/AKfycbyttCPhcDJ_PVMSO7hfSATFH1vSojT15bknuioFVx0OySy-m6W3DllE3jjGKQU-e-BCBg/exec";

const LOGGING_ENABLED = false;

/* ================= DATA ================= */

const pages = [
  /* ===== PHASE I - Block 1 ===== */
  `<p>When Mr. Hiram B. Otis, the American Minister <span style="color: green">(als Mr. Hiram B. Otis, der amerikanische Minister)</span>, bought Canterville Chase, everyone told him <span style="color: green">(/die/ Canterville-Jagd kaufte = "das Jagdschloss von Canterville kaufte", sagten ihm alle; <i>to buy, bought, bought ‚Äì kaufen; chase ‚Äì die Jagd, das Jagdreviere, die Jagdgr√ºnde; in dieser Geschichte ‚Äì die Canterville-Jagd, das Jagdschloss von Canterville</i>)</span> it was a bad idea <span style="color: green">(es sei eine schlechte Idee)</span>. The place had a ghost <span style="color: green">(der Ort hatte einen Geist)</span>. There was no doubt about that <span style="color: green">(daran gab es keinen Zweifel; <i>doubt ‚Äì die Zweifel</i>)</span>. Lord Canterville was a man <span style="color: green">(Lord Canterville war ein Mann)</span> who paid attention to detail <span style="color: green">(der auf Details achtete; <i>to pay attention to smth. ‚Äì Aufmerksamkeit schenken, aufpassen, achten auf, sich k√ºmmern um; to pay ‚Äì bezahlen; attention ‚Äì die Aufmerksamkeit, die Achtung, die Beachtung</i>)</span>. He felt it was his duty <span style="color: green">(er f√ºhlte, dass es seine Pflicht war; <i>to feel, felt, felt ‚Äì f√ºhlen, sich f√ºhlen, sich befinden, meinen, sp√ºren, glauben</i>)</span> to tell Mr. Otis about the ghost <span style="color: green">(Mr. Otis von dem Geist zu erz√§hlen; <i>to tell, told, told ‚Äì sagen, erz√§hlen, berichten</i>)</span>. This happened <span style="color: green">(dies geschah; <i>to happen ‚Äì passieren, geschehen</i>)</span> when they sat down <span style="color: green">(als sie sich hinsetzten; <i>to sit down ‚Äì hinsetzen, niederlassen; to sit, sat, sat ‚Äì sitzen</i>)</span> to discuss the terms <span style="color: green">(um die Bedingungen zu besprechen; <i>to discuss ‚Äì diskutieren, besprechen, er√∂rtern; terms ‚Äì Bedingungen, Begriffe, Konditionen</i>)</span>.</p>

<p>"We never lived here ourselves <span style="color: green">(wir haben selbst nie hier gelebt)</span>," said Lord Canterville <span style="color: green">(sagte Lord Canterville)</span>, "my grandaunt, the Dowager Duchess of Bolton <span style="color: green">(meine Gro√ütante, die Witwe Herzogin von Bolton)</span>, got frightened <span style="color: green">(bekam Angst; <i>to frighten ‚Äì erschrecken, √§ngstigen</i>)</span>.</p>`,
  
  /* ===== PHASE II - Block 1 ===== */
  `<p>When Mr. Hiram B. Otis, the American Minister, bought Canterville Chase, everyone told him it was a bad idea. The place had a ghost. There was no doubt about that. Lord Canterville was a man who paid attention to detail. He felt it was his duty to tell Mr. Otis about the ghost. This happened when they sat down to discuss the terms.</p>

<p>"We never lived here ourselves," said Lord Canterville, "my grandaunt, the Dowager Duchess of Bolton, got frightened.</p>`,
  
  /* ===== PHASE I - Block 2 ===== */
  `<p>Two skeleton hands <span style="color: green">(zwei Skeletth√§nde)</span> were placed on her shoulders <span style="color: green">(wurden auf ihre Schultern gelegt; <i>to place ‚Äì legen, stellen, platzieren</i>)</span>. It happened <span style="color: green">(es passierte)</span> when she was dressing for dinner <span style="color: green">(als sie sich zum Abendessen anzog; <i>to dress ‚Äì anziehen, kleiden</i>)</span>. She never recovered <span style="color: green">(sie erholte sich nie; <i>to recover ‚Äì sich erholen, sich fassen, zu sich kommen</i>)</span>. I feel <span style="color: green">(ich f√ºhle)</span> I need to tell you something, Mr. Otis <span style="color: green">(ich muss Ihnen etwas sagen, Mr. Otis)</span>. Several living members of my family <span style="color: green">(mehrere lebende Mitglieder von meiner Familie; <i>several ‚Äì einige, mehrere; family member ‚Äì der Familienangeh√∂rige, das Familienmitglied; member ‚Äì das Mitglied</i>)</span> saw the ghost <span style="color: green">(sahen den Geist)</span>. The rector of the parish, the Rev. Augustus Dampier <span style="color: green">(der Rektor der Gemeinde, Rev. Augustus Dampier; <i>parish ‚Äì die Gemeinde, die Kirchgemeinde, die Pfarrei; Rev. ‚Äì der Geistliche</i>)</span>, who is a Fellow of King's College, Cambridge <span style="color: green">(der ein Mitglied des King's College, Cambridge ist)</span> saw him as well <span style="color: green">(sah ihn ebenfalls; <i>to see, saw, seen ‚Äì sehen; as well ‚Äì ebenfalls</i>)</span>. After what happened to the Duchess <span style="color: green">(nach dem, was mit der Herzogin geschah)</span>, the younger servants did not want <span style="color: green">(wollten die j√ºngeren Diener nicht)</span> to stay with us <span style="color: green">(bei uns bleiben; <i>to stay with sb./sth. ‚Äì bei jdm./etw. bleiben</i>)</span>. Lady Canterville could <span style="color: green">(Lady Canterville konnte)</span> not sleep at night because of mysterious noises <span style="color: green">(nachts wegen mysteri√∂ser Ger√§usche nicht schlafen; <i>to sleep, slept, slept ‚Äì schlafen; noise ‚Äì das Ger√§usch</i>)</span>. They came from the corridor and the library <span style="color: green">(sie kamen aus dem Korridor und der Bibliothek)</span>.</p>`,
  
  /* ===== PHASE II - Block 2 ===== */
  `<p>Two skeleton hands were placed on her shoulders. It happened when she was dressing for dinner. She never recovered. I feel I need to tell you something, Mr. Otis. Several living members of my family saw the ghost. The rector of the parish, the Rev. Augustus Dampier, who is a Fellow of King's College, Cambridge saw him as well. After what happened to the Duchess, the younger servants did not want to stay with us. Lady Canterville could not sleep at night because of mysterious noises. They came from the corridor and the library.</p>`,
  
  /* ===== PHASE I - Block 3 ===== */
  `<p>"My Lord <span style="color: green">(mein Lord)</span>," answered the Minister <span style="color: green">(antwortete der Minister)</span>, "I will find out <span style="color: green">(ich werde herausfinden; <i>to find out ‚Äì ausforschen, herausfinden, entdecken, feststellen</i>)</span> how much the furniture and the ghost costs <span style="color: green">(wie viel die M√∂bel und der Geist kosten; <i>how much ‚Äì wie viel</i>)</span>. And I will buy them <span style="color: green">(und ich werde sie kaufen)</span>. I am from a modern country <span style="color: green">(ich bin aus einem modernen Land)</span> where you can buy everything <span style="color: green">(wo man alles kaufen kann)</span>. Young men from our country <span style="color: green">(junge M√§nner aus unserem Land)</span> are energetic <span style="color: green">(sind voller Energie)</span>. And they are like riots in Europe <span style="color: green">(und sie sind wie Unruhen in Europa; <i>riot ‚Äì der Aufruhr, die Unruhe, der Aufstand</i>)</span>. They are taking <span style="color: green">(sie bringen; <i>to take, took, taken ‚Äì nehmen, bringen</i>)</span> to America your best actors and prima-donnas <span style="color: green">(Ihre besten Schauspieler und Primadonnen nach Amerika)</span>. So, if a ghost exists <span style="color: green">(also, wenn ein Geist existiert)</span>, it will soon come to America <span style="color: green">(wird er bald nach Amerika kommen)</span>. It will be exhibited at one of our museums or on the road <span style="color: green">(er wird in einem unserer Museen oder unterwegs ausgestellt; <i>to exhibit ‚Äì ausstellen, zeigen</i>)</span>. It will be a show <span style="color: green">(es wird eine Show sein)</span>."</p>

<p>"I am afraid the ghost exists <span style="color: green">(ich f√ºrchte, der Geist existiert; <i>to be afraid ‚Äì sich f√ºrchten</i>)</span>," said Lord Canterville, smiling <span style="color: green">(sagte Lord Canterville l√§chelnd; <i>to smile ‚Äì l√§cheln</i>)</span>, "and it managed <span style="color: green">(und es gelang ihm; <i>to manage ‚Äì schaffen, bew√§ltigen</i>)</span> to resist the offers of your concert organizers <span style="color: green">(den Angeboten Ihrer Konzertveranstalter zu widerstehen; <i>to resist ‚Äì widerstehen; offer ‚Äì das Angebot; organizer ‚Äì der Organisator</i>)</span>."</p>`,
  
  /* ===== PHASE II - Block 3 ===== */
  `<p>"My Lord," answered the Minister, "I will find out how much the furniture and the ghost costs. And I will buy them. I am from a modern country where you can buy everything. Young men from our country are energetic. And they are like riots in Europe. They are taking to America your best actors and prima-donnas. So, if a ghost exists, it will soon come to America. It will be exhibited at one of our museums or on the road. It will be a show."</p>

<p>"I am afraid the ghost exists," said Lord Canterville, smiling, "and it managed to resist the offers of your concert organizers."</p>`,
  
  /* ===== PHASE I - Block 4 ===== */
  `<p>It has been around for three centuries <span style="color: green">(es gibt ihn seit drei Jahrhunderten)</span>. Since 1584 <span style="color: green">(seit 1584)</span>. It always appears before one of our family members die <span style="color: green">(er erscheint immer, bevor eines unserer Familienmitglieder stirbt; <i>to appear ‚Äì erscheinen; to die ‚Äì sterben</i>)</span>.</p>

<p>"Well, so does the family doctor for that matter, Lord Canterville <span style="color: green">(nun, das tut auch der Hausarzt, Lord Canterville; <i>for that matter ‚Äì was das betrifft, in dieser Hinsicht</i>)</span>. But, sir, ghosts do not exist <span style="color: green">(aber, mein Herr, Geister existieren nicht)</span>. I guess the laws of Nature do not make exceptions <span style="color: green">(ich vermute, die Gesetze der Natur machen keine Ausnahmen; <i>to guess ‚Äì vermuten, raten; law ‚Äì das Gesetz; exception ‚Äì die Ausnahme</i>)</span>. Even for the British aristocracy <span style="color: green">(auch nicht f√ºr die britische Aristokratie)</span>."</p>

<p>"You are certainly very natural in America <span style="color: green">(Sie sind sicherlich sehr nat√ºrlich in Amerika; <i>certainly ‚Äì sicherlich, gewiss</i>)</span>," answered Lord Canterville. He did not quite understand Mr. Otis's last phrase <span style="color: green">(er verstand Mr. Otis' letzten Satz nicht ganz; <i>quite ‚Äì ganz, v√∂llig; phrase ‚Äì der Satz, die Phrase</i>)</span>. "If you are fine with ghosts <span style="color: green">(wenn Sie mit Geistern einverstanden sind)</span>, then everything is alright <span style="color: green">(dann ist alles in Ordnung)</span>. Remember, I warned you <span style="color: green">(denken Sie daran, ich habe Sie gewarnt; <i>to warn ‚Äì warnen</i>)</span>."</p>`,
  
  /* ===== PHASE II - Block 4 ===== */
  `<p>It has been around for three centuries. Since 1584. It always appears before one of our family members die.</p>

<p>"Well, so does the family doctor for that matter, Lord Canterville. But, sir, ghosts do not exist. I guess the laws of Nature do not make exceptions. Even for the British aristocracy."</p>

<p>"You are certainly very natural in America," answered Lord Canterville. He did not quite understand Mr. Otis's last phrase. "If you are fine with ghosts, then everything is alright. Remember, I warned you."</p>`
];

let index = -1;
let startTime = null;
let logs = [];
let sessionId = "anon_" + Date.now();

/* ================= FLOW ================= */

function startReading() {
  document.getElementById("main-btn").onclick = nextPage;
  nextPage();
}

function nextPage() {
  const now = Date.now();

  if (index >= 0 && index < pages.length && startTime !== null) {
    logs.push({
      page: index + 1,
      duration: ((now - startTime) / 1000).toFixed(2)
    });
  }

  index++;

  if (index < pages.length) {
    const content = document.getElementById("content");
    content.innerHTML = pages[index];
    content.scrollTop = 0;

    document.getElementById("counter").innerHTML =
      "Seite " + (index + 1) + " von " + pages.length;

    const btn = document.getElementById("main-btn");
    btn.innerHTML = (index % 2 === 0)
      ? "Jetzt ohne √úbersetzung ‚Üí"
      : "N√§chster Block ‚Üí";

    startTime = Date.now();

  } else {
    sendLogs();

    document.getElementById("content").innerHTML =
      "<div style='text-align:center; padding: 40px;'><h3>Fertig! üéâ</h3><p>Du hast alle Lesebl√∂cke abgeschlossen.</p><p style='margin-top: 30px;'><a href='https://sites.google.com/view/str-study' style='display: inline-block; padding: 14px 30px; background: #4CAF50; color: white; text-decoration: none; border-radius: 12px; font-size: 18px; font-weight: bold;'>Zur√ºck zur Hauptseite</a></p></div>";

    document.getElementById("counter").innerHTML = "Abgeschlossen";

    const btn = document.getElementById("main-btn");
    btn.classList.add("hidden");
  }
}

/* ================= LOGGING ================= */

function sendLogs() {
  if (!LOGGING_ENABLED || !logs.length) {
    console.log("Logging disabled or no logs");
    return;
  }

  console.log("Sending logs:", logs);

  fetch(LOG_ENDPOINT, {
    method: "POST",
    headers: { "Content-Type": "text/plain;charset=utf-8" },
    body: JSON.stringify({
      session_id: sessionId,
      logs: logs
    })
  })
  .then(() => {
    console.log("Logs sent (request completed)");
  })
  .catch(err => {
    console.error("Log send failed", err);
  });
}

</script>

</body>
</html>
